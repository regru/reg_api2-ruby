<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; 'reg.api2 0.0.5'
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>REG.API 2 for Ruby</h1>

<p><a href="http://badge.fury.io/rb/reg.api2"><img src="https://badge.fury.io/rb/reg.api2.png" alt="Gem Version"></a>
<a href="https://travis-ci.org/regru/reg_api2-ruby"><img src="https://secure.travis-ci.org/regru/reg_api2-ruby.png" alt="build status"></a>
<a href="https://codeclimate.com/github/regru/reg_api2-ruby"><img src="https://codeclimate.com/github/regru/reg_api2-ruby.png" alt="Code Climate"></a>
<a href="https://coveralls.io/r/regru/reg_api2-ruby"><img src="https://coveralls.io/repos/regru/reg_api2-ruby/badge.png?branch=master" alt="Coverage Status"></a></p>

<p>REG.API v2 Implementation.</p>

<p>We want to note that Ruby client uses recommended way to access API: POST requests with JSON input/output in utf-8 encoding over HTTPS protocol.</p>

<p>This code hosted on <a href="https://github.com/regru/reg_api2-ruby">GitHub</a>.</p>

<h2>Installation</h2>

<p>Add this line to your application&#39;s Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>reg.api2</span><span class='tstring_end'>'</span></span>
</code></pre>

<p>And then execute:</p>

<pre class="code ruby"><code class="ruby">$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre class="code ruby"><code class="ruby">$ gem install reg.api2
</code></pre>

<h2>Usage</h2>

<h3>List of services by specified identifiers</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reg_api2</span><span class='tstring_end'>&quot;</span></span>

<span class='const'>RegApi2</span><span class='period'>.</span><span class='id identifier rubyid_username'>username</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>test</span><span class='tstring_end'>'</span></span>
<span class='const'>RegApi2</span><span class='period'>.</span><span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>test</span><span class='tstring_end'>'</span></span>
<span class='const'>RegApi2</span><span class='period'>.</span><span class='id identifier rubyid_lang'>lang</span>     <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ru</span><span class='tstring_end'>'</span></span>

<span class='const'>RegApi2</span><span class='period'>.</span><span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_nop'>nop</span><span class='lparen'>(</span><span class='label'>services:</span> <span class='lbracket'>[</span>
  <span class='lbrace'>{</span> <span class='label'>dname:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test.ru</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span> <span class='label'>dname:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test.su</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>servtype:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>srv_hosting_ispmgr</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span> <span class='label'>service_id:</span> <span class='int'>111111</span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span> <span class='label'>service_id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>22bug22</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='lbrace'>{</span> <span class='label'>surprise:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>surprise.ru</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>

<p>Other examples available as examples of concrete method calls.</p>

<h3>Console</h3>

<p>This gem also provides <code>regapi2console</code> utility that allows You
to query REG.API interactively using <code>irb</code> shell.</p>

<pre class="code ruby"><code class="ruby">$ regapi2console
Your default username: &quot;test&quot;, and You can change it with &quot;~/.regapi2&quot;.
1.9.3-p194 :001 &gt; folder.nop
 =&gt; {&quot;name&quot;=&gt;&quot;test_folder_name&quot;, &quot;id&quot;=&gt;&quot;-1&quot;}
1.9.3-p194 :002 &gt;
</code></pre>

<h2>Recommendations for effective use of REG.API</h2>

<p>This section provides information that will help you to make you work with REG.API more productive and convenient.</p>

<p>One of the most frequent problems our partners face when working with REG.API is exceeding the maximum request limit (1,200 requests per hour for user/ip). Both limits are acting at the same time. If the limits has exceeded then REG.API sets the error code (depends on kind of) to <code>IP_EXCEEDED_ALLOWED_CONNECTION_RATE</code> or <code>ACCOUNT_EXCEEDED_ALLOWED_CONNECTION_RATE</code>, that raised by client as exception of <span class='object_link'><a href="RegApi2/ApiError.html" title="RegApi2::ApiError (class)">RegApi2::ApiError</a></span> class.</p>

<p>The analysis of such situations showed that in most cases such problems are the results of improper use or misuse of REG.API due to bugs or design faults in the software used by partners.</p>

<p>The recommendations below will, on the one hand, allow you to preclude situations with excessive requests to REG.API leading to temporary blocking of user accounts, and, on the other hand, to reduce the load on RegRuSRS.</p>

<ol>
<li><p>We recommend you to send WHOIS requests (for the display of WHOIS data on your sites) not to REG.API, but directly to the WHOIS servers of the corresponding domain zones.</p>

<p>The advantages of this approach are as follows:</p>

<ul>
<li>The responses to WHOIS requests will arriver faster.</li>
<li>You will get data directly from its source without mediation.</li>
<li>The overall number of requests will decrease, thus the likelihood of blocking of your account due to excessive requests to REG.API decreases as well.</li>
</ul>

<p>We can offer you ready-to-use software solutions that will allow you to optimize your procedures of getting WHOIS data.</p></li>
<li><p>We recommend you to use REG.API for placing orders or changing data rather than for obtaining data. The software employed by some of our partners either do not locally store domain-related data or store incomplete data. As a result this data is dynamically downloaded from our system with the help of such functions domain_list, service/get_info, domain/get_contacts, domain/get_nss, etc.
We advise you to store all domain- and service-related locally and address to REG.API only when you want to change some data in the registry. This will ensure fast and reliable operation of your applications and minimize your dependency on the availability of our system.</p></li>
<li><p>All data change requests should be performed asynchronously.</p>

<p>Some applications perform domain/service registration operations, as well as data change operations right at the moment of processing HTTP requests from clients. But if the execution of an API request fails for some reason (connection loss, exceeding of request limit, parallel request blocking), this request will get lost and the client will receive an error message.</p>

<p>This mode of interaction is very unreliable and inconvenient for your customers.</p>

<p>We recommend you to perform all service ordering/data changing requests asynchronously using the queue mechanism. In such a case:</p>

<ul>
<li>You will exclude the possibility of API request blockings (because only one API request is performed at a time).</li>
<li>In case of connection failures the request can be repeated until it is executed (this significantly increases the system reliability).</li>
<li>In case of request processing errors (if REG.RU returned an error code), you can fix the problem and repeat the request, while the customer will not get any error messages. You can solve the major part of your customers’ problems on your own without their participation.</li>
</ul></li>
<li><p>Use bulk operations whenever possible. A lot of methods support operations over lists of services and domains at once.</p></li>
<li><p>It is a good practice to keep logs of all API request and responses. If a problem arises, logs will help you or our support engineers to efficiently locate and solve it.</p></li>
</ol>

<p>We hope that this information will be useful for you and that it will help you to optimize your work with REG.API.</p>

<h2>REG.API 2.0 overview</h2>

<h3>General interaction principles</h3>

<p>Each call of a function is atomic and synchronous, i.e. all requests are independent. All operations are also synchronous: the result of an operation returns immediately, there are no any intermediate stages during execution of operations. The choice in favor of this interaction method was made to simplify the customers’ work flow with REG.API.</p>

<p>Parallel processing of calls is available to requests not changing balance of the client on the account of REG.API provider.</p>

<h3>Method accessibility</h3>

<p>All REG.API methods can be divided into categories of accessibility. On Ruby documentation accessibility marked by note. At the moment the following categories of accessibility present:</p>

<table><thead>
<tr>
<th>Category</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>everyone</td>
<td>All methods tagged by this one are accessible to all users. Those methods does not require authentication before call.</td>
</tr>
<tr>
<td>clients</td>
<td>This tag indicates the methods which accessible only for users registered on REG.API provider. Strongly required an authenticated API request.</td>
</tr>
<tr>
<td>partners</td>
<td>Group of methods which accessible only for partners (resellers) of the REG.API provider (REG.RU LLC). Actually, partners (resellers) able to execute all methods of the REG.API without any restrictions.</td>
</tr>
</tbody></table>

<h3>Service identification parameters</h3>

<p>This group of parameters serves for identification of specific pre-ordered services.</p>

<p>Services can be identified by:</p>

<ul>
<li>service ID (both domains and services),</li>
<li>domain name (domains only),</li>
<li>domain name and service type (services only),</li>
<li>ID of a parent service, service type or subtype (services only).</li>
</ul>

<p>Identification by numeric service identifiers is the most reliable and quick method. For this reason, we recommend that you save and store domain/service IDs on your side and use them for service identification.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td></td>
<td><strong>Identification by service ID (recommended)</strong></td>
</tr>
<tr>
<td>service_id</td>
<td>Numeric service identifier.</td>
</tr>
<tr>
<td></td>
<td><strong>Identification by service ID passed by the user</strong></td>
</tr>
<tr>
<td>user_servid</td>
<td>Alphanumeric service identifier. To use such an identifier, you should define it during domain/service creation. To learn the pre-defined identifier, use the <code>RegApi2.service.get_info</code> function.</td>
</tr>
<tr>
<td></td>
<td><strong>Domain identification by name</strong></td>
</tr>
<tr>
<td>domain_name</td>
<td>Domain name. Russian domain names should be passed in the punycode or national encoding.</td>
</tr>
<tr>
<td></td>
<td><strong>Service identification by domain name and type of service (except for VPS)</strong></td>
</tr>
<tr>
<td>domain_name</td>
<td>Name of the domain the service is associated with. Russian domain names should be passed in the punycode or national encoding.</td>
</tr>
<tr>
<td>servtype</td>
<td>Service type. For example, «srv_hosting_ispmgr» for hosting or «srv_webfwd» for the web-forwarding service.</td>
</tr>
<tr>
<td></td>
<td><strong>Service identification by parent service ID, service type or subtype</strong></td>
</tr>
<tr>
<td>uplink_service_id</td>
<td>ID of the parent service with which the required service is associated.</td>
</tr>
<tr>
<td>servtype</td>
<td>Service type. For example, «srv_hosting_ispmgr» for hosting or «srv_webfwd» for the web-forwarding service.</td>
</tr>
<tr>
<td>subtype</td>
<td>Service subtype. For example, «pro» for the ISP Manager Pro license.</td>
</tr>
</tbody></table>

<h3>Service list identification parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domains</td>
<td>A list where each element includes a domain name or its service_ID in compliance with common service identification parameters. You can specify not more than 1000 services in one request.</td>
</tr>
<tr>
<td>services</td>
<td>A list where each element includes a domain name + service type or service_ID in compliance common service identification parameters.</td>
</tr>
</tbody></table>

<h3>Folder identification parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>folder_id</td>
<td>Numeric folder identifier (recommended).</td>
</tr>
<tr>
<td>folder_name</td>
<td>Folder name.</td>
</tr>
</tbody></table>

<h3>Common payment options</h3>

<p>This section describes the parameters common for the functions dealing with service ordering or renewal of services, i.e. the functions that involve payments.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>point_of_sale</td>
<td>An arbitrary string that identifies a system/web site used by the customer for placing an order for a domain. Optional field. Example: «regpanel.ru».</td>
</tr>
<tr>
<td>pay_type</td>
<td>Payment option. Currently available payment options: (WM, bank, pbank, prepay, yamoney, rapida, robox, paymer, cash, chronopay). Default value: prepay. Please note that automatic payments can be done only if the selected payment method is «prepay» and you have enough funds in your account. Otherwise, your order will be marked as unpaid and you will have to arrange the payment manually from your profile page.</td>
</tr>
<tr>
<td>ok_if_no_money</td>
<td>Enable to create bill when not enough funds to complete the operation. In this case requested operation is stored in the system, however it will be processed after submitting &quot;change payment method&quot; request via web interface. Return error if this flag not set and not enough funds to complete the operation.</td>
</tr>
</tbody></table>

<h2>Documentation</h2>

<p>Actual documentation available at <a href="https://www.reg.com/support/help/API-version2">https://www.reg.com/support/help/API-version2</a></p>

<p>For developers: Ruby client documentation can be accessed as:</p>

<pre class="code bash"><code class="bash">bundle exec rake yard
open doc/index.html
</code></pre>

<h2>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Add your tests and run <code>rake</code>.</li>
<li>Commit your changes (<code>git commit -am &#39;Add some feature&#39;</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>
</div></div>

    <div id="footer">
  Generated on Sat Oct  5 21:47:41 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7 (ruby-1.9.3).
</div>

  </body>
</html>